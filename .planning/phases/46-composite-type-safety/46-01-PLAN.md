---
phase: 46-composite-type-safety
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/composite/form-field.tsx
  - components/composite/page-header.tsx
  - components/composite/detail-page-layout.tsx
  - components/composite/form-section.tsx
autonomous: true

must_haves:
  truths:
    - "FormField label prop only accepts string values"
    - "PageHeader title prop only accepts string values (already the case)"
    - "FormSection title prop retains ReactNode for JSX usage"
    - "DetailPageLayout header prop retains ReactNode for complex header slots"
    - "TypeScript compilation succeeds with zero new errors across all pages"
  artifacts:
    - path: "components/composite/form-field.tsx"
      provides: "FormField with string-only label prop"
      contains: "label: string"
    - path: "components/composite/page-header.tsx"
      provides: "PageHeader with explicit string title (already correct)"
      contains: "title: string"
    - path: "components/composite/detail-page-layout.tsx"
      provides: "DetailPageLayout with ReactNode header (correctly retained)"
      contains: "header: React.ReactNode"
    - path: "components/composite/form-section.tsx"
      provides: "FormSection with ReactNode title (correctly retained)"
      contains: "title: React.ReactNode"
  key_links:
    - from: "components/composite/form-field.tsx"
      to: "all form pages using FormField"
      via: "label prop type enforcement"
      pattern: '<FormField label="'
---

<objective>
Tighten composite component prop types from ReactNode to string where only string values are ever passed, while preserving ReactNode for props that genuinely receive JSX content.

Purpose: Stronger type safety catches accidental misuse at compile time and clarifies component API contracts.
Output: Updated composite component type definitions with verified TypeScript compilation.
</objective>

<execution_context>
@/home/yaungni/.claude/get-shit-done/workflows/execute-plan.md
@/home/yaungni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@components/composite/form-field.tsx
@components/composite/page-header.tsx
@components/composite/detail-page-layout.tsx
@components/composite/form-section.tsx
@components/composite/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Tighten FormField label prop to string</name>
  <files>components/composite/form-field.tsx</files>
  <action>
In `components/composite/form-field.tsx`, change the `label` prop type from `React.ReactNode` to `string` in the `FormFieldProps` interface.

Change:
```typescript
label: React.ReactNode;
```
To:
```typescript
label: string;
```

This is safe because all 30+ usages across the codebase pass plain string literals (e.g., `label="Supplier"`, `label="Currency"`, `label="Notes"`). No usage passes JSX elements.

Do NOT change any other props in FormField. The `children`, `error`, and `hint` props should remain as they are.
  </action>
  <verify>Run `npx tsc --noEmit` and confirm zero new TypeScript errors. All existing FormField usages pass string literals so no consumer changes are needed.</verify>
  <done>FormField.label accepts string only. TypeScript compilation passes with no errors across all form pages that use FormField.</done>
</task>

<task type="auto">
  <name>Task 2: Add JSDoc annotations to all composite component prop types</name>
  <files>
components/composite/page-header.tsx
components/composite/form-field.tsx
components/composite/form-section.tsx
components/composite/detail-page-layout.tsx
  </files>
  <action>
Add JSDoc comments to the prop interfaces of all four composite components to document the type intent:

**page-header.tsx** — Add JSDoc to `PageHeaderProps`:
- `title`: `/** Plain text page title. Rendered as h1. */` — already `string`, no type change
- `description`: `/** Optional subtitle. Accepts ReactNode for template literals and code elements. */` — keep `React.ReactNode`
- `badge`: `/** Optional badge slot. Accepts ReactNode for icon+label combinations. */` — keep `React.ReactNode`
- `actions`: `/** Optional actions slot. Accepts ReactNode for buttons/links. */` — keep `React.ReactNode`

**form-field.tsx** — Add JSDoc to `FormFieldProps`:
- `label`: `/** Plain text label displayed above the field. */` — already changed to `string` in Task 1

**form-section.tsx** — Add JSDoc to `FormSectionProps`:
- `title`: `/** Section heading. Accepts ReactNode for dynamic titles with counts or required indicators. */` — keep `React.ReactNode`
- `icon`: `/** Optional icon displayed next to the title. */` — keep `React.ReactNode`

**detail-page-layout.tsx** — Add JSDoc to `DetailPageLayoutProps`:
- `header`: `/** Header content slot. Accepts ReactNode for title + badges + metadata combinations. */` — keep `React.ReactNode`
- `actions`: `/** Optional action buttons slot. */` — keep `React.ReactNode`
- `kpiPanel`: `/** Optional KPI metrics panel. */` — keep `React.ReactNode`

Do NOT change any types in this task except as specified. The goal is documentation of the type contracts.
  </action>
  <verify>Run `npx tsc --noEmit` and confirm zero TypeScript errors. Run `npm run build` to confirm production build succeeds.</verify>
  <done>All composite component prop interfaces have JSDoc comments documenting whether each prop is string-only or ReactNode and why. Build passes cleanly.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm run build` succeeds
3. `FormField` label prop type is `string` (not `ReactNode`)
4. `PageHeader` title prop type is `string` (was already string, confirmed unchanged)
5. `FormSection` title prop type remains `React.ReactNode` (uses JSX in invoice/new, qmhq/new, stock-in, stock-out-requests/new)
6. `DetailPageLayout` header prop type remains `React.ReactNode` (all usages pass complex JSX)
7. All four composite components have JSDoc-annotated prop interfaces
</verification>

<success_criteria>
- FormField.label is typed as `string` (tightened from ReactNode)
- PageHeader.title remains `string` (was already correct)
- FormSection.title remains `React.ReactNode` (genuinely needs it — used with JSX fragments, `<span>` elements, and `<>...</>`)
- DetailPageLayout.header remains `React.ReactNode` (genuinely needs it — all usages pass complex JSX)
- PageHeader.description remains `React.ReactNode` (genuinely needs it — used with `<code>` elements in edit pages)
- TypeScript compilation succeeds with zero new errors
- Production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/46-composite-type-safety/46-01-SUMMARY.md`
</output>
