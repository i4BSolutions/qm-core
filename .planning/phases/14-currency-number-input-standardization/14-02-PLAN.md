---
phase: 14-currency-number-input-standardization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/currency-display.tsx
  - lib/utils/index.ts
autonomous: true

must_haves:
  truths:
    - "CurrencyDisplay shows original currency on top line"
    - "CurrencyDisplay shows EUSD equivalent on bottom line (smaller, muted)"
    - "EUSD line shows even when original currency is USD (for consistency)"
    - "Component accepts amount, currency, and optional exchangeRate props"
    - "Thousand separators are used in formatted amounts"
  artifacts:
    - path: "components/ui/currency-display.tsx"
      provides: "Reusable two-line currency display component"
      exports: ["CurrencyDisplay", "CurrencyDisplayProps"]
  key_links:
    - from: "components/ui/currency-display.tsx"
      to: "lib/utils/index.ts"
      via: "formatCurrency import"
      pattern: "import.*formatCurrency.*from"
---

<objective>
Create reusable CurrencyDisplay component for consistent two-line stacked currency format

Purpose: Standardize currency display across all financial views to show original currency value with EUSD equivalent below, per Phase 14 CONTEXT decisions.

Output: New CurrencyDisplay component ready for use in cards, detail pages, lists, and form summaries
</objective>

<execution_context>
@/Users/thihaaung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thihaaung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-currency-number-input-standardization/14-CONTEXT.md
@.planning/phases/14-currency-number-input-standardization/14-RESEARCH.md
@lib/utils/index.ts
@components/ui/badge.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CurrencyDisplay component</name>
  <files>components/ui/currency-display.tsx</files>
  <action>
Create new file `components/ui/currency-display.tsx` with the following:

```typescript
"use client";

import { formatCurrency, calculateEUSD } from "@/lib/utils";
import { cn } from "@/lib/utils";

export interface CurrencyDisplayProps {
  /** The amount in original currency */
  amount: number | null | undefined;
  /** The currency code (USD, MMK, THB, CNY) */
  currency: string;
  /** Exchange rate to EUSD (amount / exchangeRate = EUSD). Default 1 for USD */
  exchangeRate?: number;
  /** Pre-calculated EUSD amount (if available, skips calculation) */
  amountEusd?: number | null;
  /** Size variant */
  size?: "sm" | "md" | "lg";
  /** Show dashes when amount is null/undefined/0 */
  showDashForEmpty?: boolean;
  /** Additional className for container */
  className?: string;
  /** Align text (for table cells) */
  align?: "left" | "right";
}

export function CurrencyDisplay({
  amount,
  currency,
  exchangeRate = 1,
  amountEusd,
  size = "md",
  showDashForEmpty = false,
  className,
  align = "left",
}: CurrencyDisplayProps) {
  // Handle empty/null amounts
  const displayAmount = amount ?? 0;
  const isEmpty = amount === null || amount === undefined || amount === 0;

  if (isEmpty && showDashForEmpty) {
    return (
      <div className={cn("flex flex-col", align === "right" && "items-end", className)}>
        <span className={cn(
          "font-mono text-slate-400",
          size === "sm" && "text-sm",
          size === "md" && "text-base",
          size === "lg" && "text-lg"
        )}>
          â€”
        </span>
      </div>
    );
  }

  // Calculate EUSD if not pre-calculated
  const eusdValue = amountEusd ?? calculateEUSD(displayAmount, exchangeRate);

  // Size-based styling
  const sizeStyles = {
    sm: {
      primary: "text-sm",
      secondary: "text-xs",
    },
    md: {
      primary: "text-base",
      secondary: "text-sm",
    },
    lg: {
      primary: "text-lg font-semibold",
      secondary: "text-sm",
    },
  };

  const styles = sizeStyles[size];

  return (
    <div className={cn("flex flex-col", align === "right" && "items-end", className)}>
      {/* Original currency - primary line */}
      <span className={cn("font-mono text-slate-200", styles.primary)}>
        {formatCurrency(displayAmount)} {currency}
      </span>
      {/* EUSD equivalent - secondary line (smaller, muted) */}
      <span className={cn("font-mono text-slate-400", styles.secondary)}>
        {formatCurrency(eusdValue)} EUSD
      </span>
    </div>
  );
}

/**
 * Compact inline version for table columns with limited space.
 * Shows original currency only, EUSD available via tooltip (to be added by parent).
 */
export interface CurrencyInlineProps {
  amount: number | null | undefined;
  currency: string;
  className?: string;
}

export function CurrencyInline({ amount, currency, className }: CurrencyInlineProps) {
  const displayAmount = amount ?? 0;
  return (
    <span className={cn("font-mono text-slate-200", className)}>
      {formatCurrency(displayAmount)} {currency}
    </span>
  );
}
```

Key design decisions per CONTEXT.md:
- Two lines stacked: original on top, EUSD below
- EUSD line always shows (even for USD) for consistency
- Smaller font + muted color (text-slate-400) for EUSD line
- Supports pre-calculated amountEusd or calculates from exchangeRate
- showDashForEmpty option for null values (Claude's discretion: show dashes)
  </action>
  <verify>File exists at components/ui/currency-display.tsx with CurrencyDisplay export</verify>
  <done>CurrencyDisplay component is created with all variants</done>
</task>

<task type="auto">
  <name>Task 2: Verify TypeScript compilation</name>
  <files>components/ui/currency-display.tsx</files>
  <action>
Run TypeScript check to ensure no compilation errors:
```bash
npm run type-check
```

If errors occur, fix them in the component file.
  </action>
  <verify>npm run type-check passes without errors</verify>
  <done>TypeScript compilation succeeds with new component</done>
</task>

</tasks>

<verification>
- [ ] components/ui/currency-display.tsx exists
- [ ] CurrencyDisplay and CurrencyInline are exported
- [ ] Component handles null/undefined amounts correctly
- [ ] npm run type-check passes
- [ ] Two-line format with original currency on top, EUSD below
</verification>

<success_criteria>
CurrencyDisplay component is ready for use across all financial displays with consistent two-line stacked format.
</success_criteria>

<output>
After completion, create `.planning/phases/14-currency-number-input-standardization/14-02-SUMMARY.md`
</output>
