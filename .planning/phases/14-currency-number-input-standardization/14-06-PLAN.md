---
phase: 14-currency-number-input-standardization
plan: 06
type: execute
wave: 3
depends_on: ["14-02"]
files_modified:
  - app/(dashboard)/qmhq/[id]/page.tsx
  - app/(dashboard)/po/[id]/page.tsx
  - app/(dashboard)/invoice/[id]/page.tsx
  - app/(dashboard)/inventory/page.tsx
  - app/(dashboard)/inventory/stock-in/page.tsx
autonomous: true

must_haves:
  truths:
    - "QMHQ detail page shows original currency + EUSD for expense/PO routes"
    - "PO detail page shows original currency + EUSD in financial sections"
    - "Invoice detail page shows original currency + EUSD in financial sections"
    - "Inventory dashboard KPIs show currency values with EUSD equivalent"
    - "Stock-in summary shows original currency + EUSD"
  artifacts:
    - path: "app/(dashboard)/qmhq/[id]/page.tsx"
      provides: "QMHQ detail with two-line currency display"
      contains: "CurrencyDisplay"
    - path: "app/(dashboard)/po/[id]/page.tsx"
      provides: "PO detail with two-line currency display"
      contains: "CurrencyDisplay"
    - path: "app/(dashboard)/invoice/[id]/page.tsx"
      provides: "Invoice detail with two-line currency display"
      contains: "CurrencyDisplay"
  key_links:
    - from: "app/(dashboard)/po/[id]/page.tsx"
      to: "components/ui/currency-display.tsx"
      via: "import CurrencyDisplay"
      pattern: "import.*CurrencyDisplay.*from"
---

<objective>
Update detail pages to use CurrencyDisplay for consistent two-line currency format

Purpose: Apply the CurrencyDisplay component to QMHQ, PO, Invoice detail pages and inventory dashboard to complete the standardization of currency displays across all views.

Output: All detail page financial displays show two-line format (original currency on top, EUSD below)
</objective>

<execution_context>
@/Users/thihaaung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thihaaung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-currency-number-input-standardization/14-CONTEXT.md
@.planning/phases/14-currency-number-input-standardization/14-02-SUMMARY.md
@components/ui/currency-display.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update QMHQ and PO detail pages</name>
  <files>app/(dashboard)/qmhq/[id]/page.tsx, app/(dashboard)/po/[id]/page.tsx</files>
  <action>
**QMHQ Detail Page (`app/(dashboard)/qmhq/[id]/page.tsx`):**

1. **Import CurrencyDisplay**:
```typescript
import { CurrencyDisplay } from "@/components/ui/currency-display";
```

2. **Find financial amount displays** for expense and PO routes:
   - Budget/Amount section
   - Balance displays
   - Transaction summaries

3. **Replace with CurrencyDisplay**:
   - For each amount, use the entity's `amount`, `currency`, and `amount_eusd` fields
   - Use appropriate size prop based on context (sm for inline, md for primary displays)

4. **Item route sections** should NOT show currency displays (no financial amounts)

**PO Detail Page (`app/(dashboard)/po/[id]/page.tsx`):**

1. **Import CurrencyDisplay**:
```typescript
import { CurrencyDisplay } from "@/components/ui/currency-display";
```

2. **Update financial sections**:
   - Total Amount display
   - QMHQ budget reference (if shown)
   - Any line item totals in summary sections

3. **Use CurrencyDisplay** with po's total_amount, currency, total_amount_eusd
  </action>
  <verify>grep -c "CurrencyDisplay" app/(dashboard)/qmhq/[id]/page.tsx shows 1+ match; grep -c "CurrencyDisplay" app/(dashboard)/po/[id]/page.tsx shows 1+ match</verify>
  <done>QMHQ and PO detail pages use CurrencyDisplay for financial sections</done>
</task>

<task type="auto">
  <name>Task 2: Update Invoice detail page</name>
  <files>app/(dashboard)/invoice/[id]/page.tsx</files>
  <action>
**Invoice Detail Page (`app/(dashboard)/invoice/[id]/page.tsx`):**

1. **Import CurrencyDisplay**:
```typescript
import { CurrencyDisplay } from "@/components/ui/currency-display";
```

2. **Update financial sections**:
   - Total Amount display in header/summary
   - Line item subtotals (if displayed)
   - Any financial KPIs or summaries

3. **Use CurrencyDisplay** with invoice's total_amount, currency, total_amount_eusd

4. **Review any related tabs** (stock receipts, history) for currency displays
  </action>
  <verify>grep -c "CurrencyDisplay" app/(dashboard)/invoice/[id]/page.tsx shows 1+ match</verify>
  <done>Invoice detail page uses CurrencyDisplay for financial sections</done>
</task>

<task type="auto">
  <name>Task 3: Update Inventory pages</name>
  <files>app/(dashboard)/inventory/page.tsx, app/(dashboard)/inventory/stock-in/page.tsx</files>
  <action>
**Inventory Dashboard (`app/(dashboard)/inventory/page.tsx`):**

1. **Import CurrencyDisplay**:
```typescript
import { CurrencyDisplay } from "@/components/ui/currency-display";
```

2. **Update KPI cards** that show financial values:
   - Total Value display
   - Any transaction value summaries

3. **Transaction list items**:
   - If transactions show amounts inline, update to CurrencyDisplay
   - Transactions have unit_cost, currency, and potentially calculated EUSD

**Stock-In Page (`app/(dashboard)/inventory/stock-in/page.tsx`):**

1. **Import CurrencyDisplay** (may already be partially done in Plan 03)

2. **Update summary section** at bottom:
   - Total Value display should show original currency + EUSD

3. **EUSD calculation panel** (manual mode):
   - Review if this needs CurrencyDisplay or if current layout (showing calculation breakdown) is appropriate
   - The calculation display may benefit from keeping its formula-style layout

4. **Invoice mode totals**:
   - Update to show two-line format
  </action>
  <verify>grep -c "CurrencyDisplay" app/(dashboard)/inventory/page.tsx shows 1+ match; npm run type-check passes</verify>
  <done>Inventory pages use CurrencyDisplay for financial displays</done>
</task>

</tasks>

<verification>
- [ ] QMHQ detail shows two-line currency format for expense/PO routes
- [ ] PO detail shows two-line currency format in financial sections
- [ ] Invoice detail shows two-line currency format in financial sections
- [ ] Inventory dashboard KPIs show two-line format where appropriate
- [ ] Stock-in summary shows two-line format
- [ ] npm run type-check passes
- [ ] npm run lint passes (or acceptable warnings)
</verification>

<success_criteria>
All detail pages and inventory views consistently display financial amounts in two-line stacked format with original currency above EUSD equivalent.
</success_criteria>

<output>
After completion, create `.planning/phases/14-currency-number-input-standardization/14-06-SUMMARY.md`
</output>
