---
phase: 26-currency-unification
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/(dashboard)/qmhq/[id]/page.tsx
  - app/(dashboard)/qmhq/page.tsx
autonomous: true

must_haves:
  truths:
    - "QMHQ detail page transaction list shows dual currency (org + EUSD)"
    - "QMHQ list cards show amounts in both org currency and EUSD"
    - "All QMHQ financial amounts use CurrencyDisplay component"
  artifacts:
    - path: "app/(dashboard)/qmhq/[id]/page.tsx"
      provides: "Dual currency transaction display"
      contains: "CurrencyDisplay"
    - path: "app/(dashboard)/qmhq/page.tsx"
      provides: "Dual currency list cards"
      contains: "CurrencyDisplay"
  key_links:
    - from: "app/(dashboard)/qmhq/[id]/page.tsx"
      to: "components/ui/currency-display.tsx"
      via: "import and render"
      pattern: "import.*CurrencyDisplay"
---

<objective>
Update QMHQ detail page and list page to show dual currency (org + EUSD) for all financial amounts using the existing CurrencyDisplay component.

Purpose: Provides consistent dual-currency display across all QMHQ views, always showing both original currency and EUSD equivalent.
Output: Updated QMHQ detail and list pages with CurrencyDisplay for all amounts.
</objective>

<execution_context>
@/Users/thihaaung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thihaaung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/26-currency-unification/26-CONTEXT.md
@components/ui/currency-display.tsx
@app/(dashboard)/qmhq/[id]/page.tsx
@app/(dashboard)/qmhq/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update transaction list to use CurrencyDisplay</name>
  <files>app/(dashboard)/qmhq/[id]/page.tsx</files>
  <action>
Update the transaction list (lines ~1003-1015) to use CurrencyDisplay instead of inline formatting:

Current code (around lines 1003-1015):
```typescript
<div className="text-right">
  <p className={`text-lg font-mono font-bold ${
    tx.transaction_type === "money_in"
      ? "text-emerald-400"
      : "text-amber-400"
  }`}>
    {tx.transaction_type === "money_in" ? "+" : "-"}{formatCurrency(tx.amount_eusd ?? 0)} EUSD
  </p>
  <p className="text-xs text-slate-400">
    {formatCurrency(tx.amount ?? 0)} {tx.currency}
  </p>
</div>
```

Replace with CurrencyDisplay:
```typescript
<div className="text-right">
  <div className={`${
    tx.transaction_type === "money_in"
      ? "[&_.font-mono]:text-emerald-400"
      : "[&_.font-mono]:text-amber-400"
  }`}>
    <CurrencyDisplay
      amount={tx.amount}
      currency={tx.currency || "MMK"}
      amountEusd={tx.amount_eusd}
      size="md"
      align="right"
      context="card"
    />
  </div>
</div>
```

Note: The +/- sign is implicit from context (money_in vs money_out is shown via icon and badge). Per user decision, using CurrencyDisplay directly which shows org currency primary, EUSD secondary.

Alternative approach if color override doesn't work cleanly:
```typescript
<div className="text-right">
  <p className={`text-lg font-mono font-bold ${
    tx.transaction_type === "money_in" ? "text-emerald-400" : "text-amber-400"
  }`}>
    {tx.transaction_type === "money_in" ? "+" : "-"}{formatCurrency(tx.amount ?? 0)} {tx.currency || "MMK"}
  </p>
  <p className={`text-sm font-mono ${
    tx.transaction_type === "money_in" ? "text-emerald-400/70" : "text-amber-400/70"
  }`}>
    {tx.transaction_type === "money_in" ? "+" : "-"}{formatCurrency(tx.amount_eusd ?? 0)} EUSD
  </p>
</div>
```

Choose the approach that maintains visual consistency with existing color coding while showing both currencies.
  </action>
  <verify>
1. `npm run build` passes
2. Navigate to QMHQ detail page (expense or po route)
3. Go to Transactions tab
4. Each transaction shows amount in org currency AND EUSD
5. Colors remain correct (emerald for money-in, amber for money-out)
  </verify>
  <done>
Transaction list shows dual currency (org primary, EUSD secondary) for each transaction with appropriate color coding.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update QMHQ list cards to use CurrencyDisplay</name>
  <files>app/(dashboard)/qmhq/page.tsx</files>
  <action>
Find the QMHQ list page and update card amount display to use CurrencyDisplay.

1. First, read the file to find where amounts are displayed on cards

2. Look for patterns like:
```typescript
{formatCurrency(qmhq.amount_eusd)} EUSD
// or
{formatCurrency(qmhq.amount)} {qmhq.currency}
```

3. Replace with CurrencyDisplay:
```typescript
<CurrencyDisplay
  amount={qmhq.amount}
  currency={qmhq.currency || "MMK"}
  amountEusd={qmhq.amount_eusd}
  size="md"
  context="card"
  fluid
/>
```

4. Ensure CurrencyDisplay is imported at the top if not already

5. Apply to all card views where financial amounts are shown (expense and po route cards)

Note: Item route cards don't have financial amounts, only expense and po routes.

If the list page uses a card component from /components/qmhq/, update that component instead.
  </action>
  <verify>
1. `npm run build` passes
2. Navigate to /qmhq
3. View cards for expense and po route QMHQs
4. Each card shows amount in org currency AND EUSD (two-line format)
5. Compact formatting (K/M/B) works for large amounts
  </verify>
  <done>
QMHQ list cards show dual currency display (org primary, EUSD secondary) for expense and po route entries.
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. QMHQ Detail Page:
   - Navigate to expense/po route QMHQ detail
   - Transactions tab shows each transaction with both currencies
   - Summary cards at top already use CurrencyDisplay (verify no regression)
3. QMHQ List Page:
   - Navigate to /qmhq
   - Cards for expense/po routes show dual currency
   - Large amounts abbreviate with K/M/B per Phase 24 thresholds
</verification>

<success_criteria>
- QMHQ detail transaction list shows org + EUSD (CURR-03)
- QMHQ list cards show org + EUSD (CURR-04)
- Consistent two-line format (org primary, EUSD secondary)
- Compact formatting from Phase 24 preserved
</success_criteria>

<output>
After completion, create `.planning/phases/26-currency-unification/26-02-SUMMARY.md`
</output>
