---
phase: 36-ui-component-standardization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/composite/detail-page-layout.tsx
  - components/composite/card-view-grid.tsx
  - components/composite/index.ts
autonomous: true

must_haves:
  truths:
    - "DetailPageLayout component renders back button, header content, optional KPI panel, and tabs with consistent spacing"
    - "CardViewGrid component renders items grouped by status in a 3-column grid with column headers, counters, and empty states"
    - "All composite components are importable via barrel export from @/components/composite"
  artifacts:
    - path: "components/composite/detail-page-layout.tsx"
      provides: "Detail page structure with back nav, header, KPI panel, tabs"
      contains: "export function DetailPageLayout"
    - path: "components/composite/card-view-grid.tsx"
      provides: "Generic grouped card grid with render props"
      contains: "export function CardViewGrid"
    - path: "components/composite/index.ts"
      provides: "Barrel export for all composite components"
      contains: "export { PageHeader }"
  key_links:
    - from: "components/composite/card-view-grid.tsx"
      to: "app/globals.css"
      via: "CSS classes"
      pattern: "column-header|status-dot|stat-counter"
    - from: "components/composite/detail-page-layout.tsx"
      to: "components/ui/button.tsx"
      via: "import"
      pattern: "from \"@/components/ui/button\""
    - from: "components/composite/index.ts"
      to: "components/composite/page-header.tsx"
      via: "re-export"
      pattern: "export .* from"
---

<objective>
Create 2 layout composite components (DetailPageLayout, CardViewGrid) and a barrel export index.ts that re-exports all 7 composite components for clean imports.

Purpose: DetailPageLayout standardizes the back-button + header + KPI panel + tabs pattern used across detail pages (Item, QMRL, QMHQ, PO, Invoice). CardViewGrid standardizes the 3-column status-grouped card view used across list pages (QMRL, PO, QMHQ, Invoice).

Output: 3 new files in `components/composite/` directory.
</objective>

<execution_context>
@/home/yaungni/.claude/get-shit-done/workflows/execute-plan.md
@/home/yaungni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/36-ui-component-standardization/36-RESEARCH.md

Reference existing patterns:
@app/(dashboard)/item/[id]/page.tsx — Source of detail page layout pattern (back button, header, KPI panel, tabs)
@app/(dashboard)/qmrl/page.tsx — Source of card view grid pattern (3-column kanban with status groups)
@app/(dashboard)/po/page.tsx — Source of card view grid pattern (3-column grouped POs)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DetailPageLayout and CardViewGrid composites</name>
  <files>
    components/composite/detail-page-layout.tsx
    components/composite/card-view-grid.tsx
  </files>
  <action>
**detail-page-layout.tsx (Server Component, no "use client"):**

Export `DetailPageLayout` function component.

Props interface `DetailPageLayoutProps`:
- `backHref: string` — URL for back button navigation
- `backLabel?: string` — label for back button (default "Back")
- `header: React.ReactNode` — slot for the header area (title, badges, etc.)
- `actions?: React.ReactNode` — slot for action buttons (Edit, Stock In, etc.)
- `kpiPanel?: React.ReactNode` — slot for the KPI/summary panel below header
- `children: React.ReactNode` — main content area (tabs, etc.)
- `className?: string`

Layout structure (matches existing item detail page pattern):
```
<div className="space-y-6 relative">
  {/* Grid overlay — matches existing pattern */}
  <div className="fixed inset-0 pointer-events-none grid-overlay opacity-30" />

  {/* Header row */}
  <div className="relative flex items-start justify-between animate-fade-in">
    <div className="flex items-start gap-4">
      {/* Back button */}
      <Link href={backHref}>
        <Button variant="ghost" size="icon" className="mt-1 hover:bg-amber-500/10 hover:text-amber-500">
          <ArrowLeft className="h-5 w-5" />
        </Button>
      </Link>
      {/* Header content slot */}
      {header}
    </div>
    {/* Actions slot */}
    {actions && <div className="flex items-center gap-2">{actions}</div>}
  </div>

  {/* Optional KPI panel */}
  {kpiPanel}

  {/* Main content */}
  {children}
</div>
```

Imports: Link from "next/link", ArrowLeft from "lucide-react", Button from "@/components/ui/button", cn from "@/lib/utils".

**card-view-grid.tsx (Client Component, "use client" — uses useMemo for grouping):**

Export `CardViewGrid` as a generic function component with type parameter `<T>`.

Props interface `CardViewGridProps<T>`:
- `items: T[]` — array of items to display
- `groups: { key: string; label: string; dotClass: string }[]` — group configuration (e.g., [{ key: "to_do", label: "PENDING", dotClass: "status-dot status-dot-todo" }])
- `groupBy: (item: T) => string` — function that returns the group key for an item
- `renderCard: (item: T, index: number) => React.ReactNode` — render prop for card content
- `emptyMessage?: string` — message for empty groups (default "No items")
- `className?: string`

Implementation:
1. Use `useMemo` to group items by calling `groupBy()` on each item and bucketing into a `Record<string, T[]>`
2. Render a 3-column grid: `grid gap-6 lg:grid-cols-3`
3. For each group in `groups` array:
   - Column header: `div` with `column-header` class (existing CSS from globals.css), containing:
     - Status dot: `div` with `group.dotClass`
     - Label: `h2` with `text-sm font-bold uppercase tracking-widest text-slate-200`
     - Counter: `span` with `stat-counter ml-auto` showing count
   - Column body: `div` with `flex-1 rounded-b-lg border border-t-0 border-slate-700 bg-slate-900/30 p-3 min-h-[400px]`
   - Inside body: `space-y-3` container
   - If group is empty: show `div` with `flex h-32 items-center justify-center rounded-lg border border-dashed border-slate-700` and `p` with `text-sm text-slate-400` showing `emptyMessage`
   - If group has items: map and call `renderCard(item, index)` for each

This exactly matches the existing kanban column pattern from QMRL page (lines 324-436) and PO page card view (lines 389-421), extracted into a reusable component.

Imports: "use client", useMemo from "react", cn from "@/lib/utils".
  </action>
  <verify>
Run `npx tsc --noEmit`. Both files must compile. Verify: `ls components/composite/detail-page-layout.tsx components/composite/card-view-grid.tsx`.
  </verify>
  <done>
DetailPageLayout and CardViewGrid exist in components/composite/, compile cleanly. DetailPageLayout is a Server Component. CardViewGrid is a Client Component with generic type parameter.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create barrel export for all composite components</name>
  <files>
    components/composite/index.ts
  </files>
  <action>
Create `components/composite/index.ts` as a barrel export file that re-exports all composite components. This enables clean imports like `import { PageHeader, FilterBar } from "@/components/composite"`.

Contents:
```typescript
// Composite components - standardized UI patterns
// These wrap existing UI primitives into higher-level page-building blocks

export { PageHeader } from "./page-header";
export type { PageHeaderProps } from "./page-header";

export { FilterBar } from "./filter-bar";

export { ActionButtons } from "./action-buttons";

export { FormField } from "./form-field";

export { FormSection, formSectionVariants } from "./form-section";

export { DetailPageLayout } from "./detail-page-layout";

export { CardViewGrid } from "./card-view-grid";
```

Note: Only export types that are explicitly named and exported from source files. If source files use inline interfaces (not exported), skip the type re-export for those — the consumer will get type inference from the component props.

Verify that each import path resolves correctly by checking that the named exports exist in each file. Adjust export names to match actual exported names from Tasks 1 (plan 01) and Task 1 (this plan).
  </action>
  <verify>
Run `npx tsc --noEmit`. The barrel file must compile. All re-exports must resolve without errors.
  </verify>
  <done>
Barrel export at components/composite/index.ts re-exports all 7 composite components. Import `from "@/components/composite"` resolves for PageHeader, FilterBar, ActionButtons, FormField, FormSection, DetailPageLayout, CardViewGrid.
  </done>
</task>

</tasks>

<verification>
1. `ls components/composite/` shows 8 files: page-header.tsx, filter-bar.tsx, action-buttons.tsx, form-field.tsx, form-section.tsx, detail-page-layout.tsx, card-view-grid.tsx, index.ts
2. `npx tsc --noEmit` passes with no errors
3. detail-page-layout.tsx does NOT contain "use client"
4. card-view-grid.tsx DOES contain "use client"
5. index.ts re-exports all 7 components
6. CardViewGrid uses generic type parameter `<T>`
7. DetailPageLayout has backHref, header, actions, kpiPanel, children slots
</verification>

<success_criteria>
- DetailPageLayout provides consistent back-button + header + KPI + content structure
- CardViewGrid provides generic grouped card grid with render props pattern
- Barrel export enables `import { PageHeader, FilterBar, CardViewGrid } from "@/components/composite"`
- All components compile without errors
- No new npm dependencies required
</success_criteria>

<output>
After completion, create `.planning/phases/36-ui-component-standardization/36-02-SUMMARY.md`
</output>
