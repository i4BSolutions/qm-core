---
phase: 50-standard-quantity-display
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/standard-unit-display.tsx
autonomous: true

must_haves:
  truths:
    - "StandardUnitDisplay renders two-line format: original qty on top, standard qty below in smaller muted text"
    - "StandardUnitDisplay hides the second line entirely when no standard unit name is configured"
    - "StandardUnitDisplay formats numbers with thousand separators matching CurrencyDisplay pattern"
  artifacts:
    - path: "components/ui/standard-unit-display.tsx"
      provides: "Reusable two-line quantity display component mirroring CurrencyDisplay"
      exports: ["StandardUnitDisplay", "StandardUnitDisplayProps"]
  key_links:
    - from: "components/ui/standard-unit-display.tsx"
      to: "lib/hooks/use-standard-unit-name.ts"
      via: "useStandardUnitName hook import"
      pattern: "useStandardUnitName"
---

<objective>
Create the StandardUnitDisplay component that mirrors CurrencyDisplay's two-line pattern for quantities.

Purpose: This is the foundational display component that all subsequent plans (02, 03, 04) will use to show standard quantities alongside original quantities throughout the system.
Output: `components/ui/standard-unit-display.tsx` with exported StandardUnitDisplay component.
</objective>

<execution_context>
@/home/yaungni/.claude/get-shit-done/workflows/execute-plan.md
@/home/yaungni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@components/ui/currency-display.tsx
@lib/hooks/use-standard-unit-name.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create StandardUnitDisplay component</name>
  <files>components/ui/standard-unit-display.tsx</files>
  <action>
Create `components/ui/standard-unit-display.tsx` as a "use client" component mirroring CurrencyDisplay's two-line pattern.

**Component API:**
```tsx
interface StandardUnitDisplayProps {
  /** Original quantity */
  quantity: number | null | undefined;
  /** Conversion rate for this transaction */
  conversionRate: number;
  /** Size variant matching CurrencyDisplay */
  size?: "sm" | "md" | "lg";
  /** Align text */
  align?: "left" | "right";
  /** Additional className */
  className?: string;
}
```

**Implementation details (mirror CurrencyDisplay exactly):**

1. Import and call `useStandardUnitName()` hook to get `unitName` and `isLoading`.

2. Calculate standard qty: `standardQty = (quantity ?? 0) * conversionRate`.

3. Format both quantities with `toLocaleString()` using thousand separators and 2 decimal places (matching CurrencyDisplay's number formatting approach). Use `Intl.NumberFormat` with `minimumFractionDigits: 2, maximumFractionDigits: 2` for consistent display.

4. **Two-line layout** (directly mirrors CurrencyDisplay structure):
   - Primary line: original quantity in `font-mono text-slate-200` (same as CurrencyDisplay primary)
   - Secondary line: standard qty + unitName in `font-mono text-slate-400` with smaller font (same muted color/size as EUSD line in CurrencyDisplay)

5. **Size styles** (copied from CurrencyDisplay):
   - sm: primary `text-sm`, secondary `text-xs`
   - md: primary `text-base`, secondary `text-sm`
   - lg: primary `text-lg font-semibold`, secondary `text-sm`

6. **Conditional rendering per user decision:**
   - If `isLoading` is true: show only the primary quantity line (no second line)
   - If `unitName` is empty or equals default sentinel: hide the standard qty line entirely
   - Per CONTEXT.md decision: "If admin has NOT configured a standard unit name: hide the standard qty line entirely"
   - Since the DB seeds "Standard Units" as default, treat this as "configured". Only hide if the hook returns empty string.

7. **Container:** `flex flex-col min-w-0` with alignment support, matching CurrencyDisplay's container pattern.

8. **Secondary line format:** `{formattedStandardQty} {unitName}` — mirrors EUSD line which shows `{amount} EUSD`.

**Edge case handling (Claude's discretion from CONTEXT.md):**
- When `quantity` is null/undefined, display `0.00` (matching CurrencyDisplay's behavior for null amounts)
- Always show the second line when unitName is configured (even when conversion_rate = 1, since the user may be using a different unit system)

Do NOT use the compact/abbreviated formatting from CurrencyDisplay (no tooltip, no abbreviation thresholds). Quantities are typically smaller numbers and don't need K/M/B abbreviation.
  </action>
  <verify>
Run `npx tsc --noEmit 2>&1 | grep -c "standard-unit-display"` — should return 0 (no type errors in the new file).
Verify the file exists: `ls components/ui/standard-unit-display.tsx`
  </verify>
  <done>
StandardUnitDisplay component exists at components/ui/standard-unit-display.tsx, exports StandardUnitDisplay and StandardUnitDisplayProps, mirrors CurrencyDisplay two-line pattern, uses useStandardUnitName hook, hides second line when unit name not configured.
  </done>
</task>

</tasks>

<verification>
1. `components/ui/standard-unit-display.tsx` exists and exports StandardUnitDisplay
2. Component uses `useStandardUnitName()` hook
3. Two-line format: primary (original qty) + secondary (standard qty + unit name)
4. Size variants match CurrencyDisplay: sm, md, lg
5. Secondary line hidden when unit name not configured
6. No TypeScript errors
</verification>

<success_criteria>
- StandardUnitDisplay component is importable from `@/components/ui/standard-unit-display`
- Component renders two-line format matching CurrencyDisplay pattern
- Standard qty calculated as quantity * conversionRate
- Admin-configured unit name retrieved via useStandardUnitName hook
- Second line hidden when standard unit name is not configured
</success_criteria>

<output>
After completion, create `.planning/phases/50-standard-quantity-display/50-01-SUMMARY.md`
</output>
